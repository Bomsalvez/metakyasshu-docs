# RF004 ðŸ”„ RecuperaÃ§Ã£o de senha

## ðŸ“ DescriÃ§Ã£o

Esta funcionalidade permite que o usuÃ¡rio recupere sua senha em caso de esquecimento, utilizando o email cadastrado para
receber um link ou cÃ³digo de redefiniÃ§Ã£o.

## ðŸ‘¥ Atores

- ðŸ‘¤ UsuÃ¡rio Cadastrado

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio deve ter um email vÃ¡lido cadastrado no sistema.

## ðŸ”Œ Endpoints

- `POST /api/auth/forgot-password`
- `POST /api/auth/reset-password`

## ðŸ“‹ Dados para RecuperaÃ§Ã£o de Senha

| Campo          | Tipo     | ObrigatÃ³rio        | DescriÃ§Ã£o                     | RestriÃ§Ãµes             |
|----------------|----------|--------------------|-------------------------------|------------------------|
| `email`        | `string` | âœ… Sim              | E-mail do usuÃ¡rio             | Formato vÃ¡lido         |
| `token`        | `string` | âœ… Sim (para reset) | Token de redefiniÃ§Ã£o de senha | Gerado pelo sistema    |
| `new_password` | `string` | âœ… Sim (para reset) | Nova senha desejada           | MÃ­nimo de 8 caracteres |

## ðŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    actor U as UsuÃ¡rio
    participant S as Sistema
    participant E as ServiÃ§o de Email
    U->>S: Acessa a opÃ§Ã£o "Esqueceu a senha?"
    S->>U: Exibe formulÃ¡rio para informar email
    U->>S: Informa email cadastrado
    S->>S: Valida o email
    S->>E: Solicita envio de link/cÃ³digo de redefiniÃ§Ã£o
    E->>U: Envia email com link/cÃ³digo
    U->>U: Acessa o link/cÃ³digo no email
    U->>S: Informa nova senha e token/cÃ³digo
    S->>S: Valida token/cÃ³digo e nova senha
    S->>S: Redefine a senha do usuÃ¡rio
    S->>U: Exibe mensagem de sucesso e redireciona para login
```

1. O usuÃ¡rio acessa a opÃ§Ã£o "Esqueceu a senha?" na pÃ¡gina de login.
2. O sistema solicita o email cadastrado do usuÃ¡rio.
3. O usuÃ¡rio informa seu email e envia a solicitaÃ§Ã£o.
4. O sistema verifica se o email estÃ¡ cadastrado e, em caso positivo, gera um token ou cÃ³digo de redefiniÃ§Ã£o de senha.
5. O sistema envia um email para o endereÃ§o fornecido, contendo o link de redefiniÃ§Ã£o ou o cÃ³digo.
6. O usuÃ¡rio acessa o link ou insere o cÃ³digo no sistema.
7. O sistema solicita que o usuÃ¡rio defina uma nova senha e, em alguns casos, o token/cÃ³digo recebido.
8. O sistema valida o token/cÃ³digo e a nova senha (segundo as regras de seguranÃ§a de senha).
9. Se a validaÃ§Ã£o for bem-sucedida, o sistema redefine a senha do usuÃ¡rio.
10. O sistema exibe uma mensagem de sucesso e redireciona o usuÃ¡rio para a pÃ¡gina de login para que ele possa acessar
    sua conta com a nova senha.

## ðŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - Link/CÃ³digo Expirado

1. No passo 8 do fluxo principal, se o link ou cÃ³digo de redefiniÃ§Ã£o de senha estiver expirado, o sistema exibe uma
   mensagem de erro.
2. O sistema oferece ao usuÃ¡rio a opÃ§Ã£o de iniciar novamente o processo de recuperaÃ§Ã£o de senha.

## ðŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Email nÃ£o cadastrado

1. No passo 4 do fluxo principal, se o email informado nÃ£o estiver cadastrado no sistema, o sistema exibe uma mensagem
   de erro indicando que o email nÃ£o foi encontrado.
2. O sistema mantÃ©m o usuÃ¡rio na tela de solicitaÃ§Ã£o de email.

### âš ï¸ FE02 - Erro no envio do email

1. No passo 5 do fluxo principal, se houver um erro no envio do email de redefiniÃ§Ã£o, o sistema exibe uma mensagem de
   erro e informa ao usuÃ¡rio para tentar novamente mais tarde ou entrar em contato com o suporte.

### âš ï¸ FE03 - Nova senha invÃ¡lida

1. No passo 8 do fluxo principal, se a nova senha informada nÃ£o atender aos requisitos de seguranÃ§a (ex: muito curta,
   nÃ£o contÃ©m caracteres especiais), o sistema exibe uma mensagem de erro detalhada.
2. O sistema mantÃ©m o usuÃ¡rio na tela de redefiniÃ§Ã£o de senha para que ele possa informar uma nova senha vÃ¡lida.

## ðŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP - Solicitar RedefiniÃ§Ã£o de Senha

```http
POST /api/auth/forgot-password HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "email": "usuario@example.com"
}
```

### RequisiÃ§Ã£o HTTP - Redefinir Senha

```http
POST /api/auth/reset-password HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "token": "UM_TOKEN_GERADO_PELO_SISTEMA",
  "new_password": "NovaSenhaMuitoSegura456"
}
```

---

> ---------------------------------------------------------------------------
> #### ðŸ’° METAKYASSHU ðŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 