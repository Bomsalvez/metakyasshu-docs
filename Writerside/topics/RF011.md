# RF011 ğŸ“Š OrÃ§amento mensal/anual personalizÃ¡vel

## ğŸ“ DescriÃ§Ã£o

Esta funcionalidade permite a criaÃ§Ã£o de orÃ§amentos mensais ou anuais personalizÃ¡veis por categoria e subcategoria,
auxiliando o usuÃ¡rio a planejar e controlar seus gastos e receitas para atingir metas financeiras.

## ğŸ‘¥ Atores

- ğŸ‘¤ UsuÃ¡rio Autenticado

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio deve estar logado no sistema.
- O usuÃ¡rio deve ter categorias e subcategorias configuradas (ou usar as padrÃ£o).

## ğŸ”Œ Endpoints

- `POST /api/budgets`
- `GET /api/budgets`
- `GET /api/budgets/{budgetId}`
- `PUT /api/budgets/{budgetId}`
- `DELETE /api/budgets/{budgetId}`

## ğŸ“‹ Dados do OrÃ§amento

| Campo              | Tipo            | ObrigatÃ³rio | DescriÃ§Ã£o                                  | RestriÃ§Ãµes                                              |
|--------------------|-----------------|-------------|--------------------------------------------|---------------------------------------------------------|
| `name`             | `string`        | âœ… Sim       | Nome do orÃ§amento (ex: "OrÃ§amento Mensal") | MÃ­nimo de 3 caracteres, Ãºnico para o usuÃ¡rio no perÃ­odo |
| `period_type`      | `string`        | âœ… Sim       | Tipo de perÃ­odo do orÃ§amento               | `monthly`, `yearly`                                     |
| `start_date`       | `string`        | âœ… Sim       | Data de inÃ­cio do perÃ­odo do orÃ§amento     | Formato YYYY-MM-DD                                      |
| `end_date`         | `string`        | âœ… Sim       | Data de tÃ©rmino do perÃ­odo do orÃ§amento    | Formato YYYY-MM-DD, apÃ³s `start_date`                   |
| `category_budgets` | `array<object>` | âœ… Sim       | Detalhamento do orÃ§amento por categoria    | Array de objetos de orÃ§amento por categoria             |
| `category_id`      | `string`        | âœ… Sim       | ID da categoria                            | UUID vÃ¡lido, categoria existente                        |
| ` budgeted_amount` | `number`        | âœ… Sim       | Valor orÃ§ado para a categoria              | Valor positivo, com duas casas decimais                 |

## ğŸ”„ Fluxo Principal - CriaÃ§Ã£o de OrÃ§amento

```mermaid
sequenceDiagram
    actor U as UsuÃ¡rio
    participant S as Sistema
    participant BD as Banco de Dados
    U->>S: Acessa a seÃ§Ã£o de OrÃ§amento
    S->>U: Exibe a opÃ§Ã£o para criar novo orÃ§amento
    U->>S: Informa nome, tipo de perÃ­odo, data de inÃ­cio/fim e valores para cada categoria
    S->>S: Valida os dados do orÃ§amento e categorias
    S->>BD: Salva o novo orÃ§amento com detalhes por categoria
    BD->>S: Confirma o salvamento
    S->>U: Exibe mensagem de sucesso e o novo orÃ§amento criado
```

1. O usuÃ¡rio autenticado acessa a seÃ§Ã£o de OrÃ§amento no sistema.
2. O sistema exibe a opÃ§Ã£o para criar um novo orÃ§amento (mensal ou anual).
3. O usuÃ¡rio preenche os detalhes gerais do orÃ§amento (nome, tipo de perÃ­odo, data de inÃ­cio e fim) e, para cada
   categoria de despesa ou receita, define um valor orÃ§ado.
4. O sistema valida os dados, garantindo que os valores sejam positivos, as datas vÃ¡lidas e que o nome do orÃ§amento nÃ£o
   seja duplicado para o mesmo perÃ­odo.
5. O sistema salva o novo orÃ§amento e seus detalhes por categoria no banco de dados.
6. O sistema exibe uma mensagem de confirmaÃ§Ã£o de sucesso e o novo orÃ§amento Ã© adicionado Ã  lista de orÃ§amentos do
   usuÃ¡rio.

## ğŸ”„ Fluxo Principal - GestÃ£o de OrÃ§amentos

```mermaid
sequenceDiagram
    actor U as UsuÃ¡rio
    participant S as Sistema
    participant BD as Banco de Dados
    U->>S: Acessa a seÃ§Ã£o de OrÃ§amento
    S->>BD: Solicita lista de orÃ§amentos do usuÃ¡rio
    BD->>S: Retorna lista de orÃ§amentos
    S->>U: Exibe a lista de orÃ§amentos criados
    U->>S: Seleciona um orÃ§amento para visualizar/editar/excluir
    alt Visualizar OrÃ§amento
        S->>BD: Solicita detalhes do orÃ§amento e gastos atuais
        BD->>S: Retorna detalhes e dados de transaÃ§Ãµes
        S->>U: Exibe detalhes do orÃ§amento com progresso e alertas
    else Editar OrÃ§amento
        S->>U: Exibe formulÃ¡rio de ediÃ§Ã£o com dados atuais
        U->>S: Altera os valores orÃ§ados por categoria
        S->>S: Valida os dados atualizados
        S->>BD: Atualiza o orÃ§amento no banco de dados
        BD->>S: Confirma atualizaÃ§Ã£o
        S->>U: Exibe sucesso e orÃ§amento atualizado
    else Excluir OrÃ§amento
        S->>U: Solicita confirmaÃ§Ã£o de exclusÃ£o
        U->>S: Confirma exclusÃ£o
        S->>BD: Remove o orÃ§amento
        BD->>S: Confirma remoÃ§Ã£o
        S->>U: Exibe sucesso e remove orÃ§amento da lista
    end
```

1. O usuÃ¡rio autenticado acessa a seÃ§Ã£o de gerenciamento de orÃ§amentos.
2. O sistema exibe uma lista de todos os orÃ§amentos criados pelo usuÃ¡rio.
3. O usuÃ¡rio pode:
   a. **Visualizar:** Selecionar um orÃ§amento para ver seus detalhes, incluindo o progresso em cada categoria (quanto jÃ¡
   foi gasto/recebido em comparaÃ§Ã£o ao orÃ§ado) e alertas de estouro de orÃ§amento.
   b. **Editar:** Selecionar um orÃ§amento para modificar os valores orÃ§ados para cada categoria. O sistema valida as
   alteraÃ§Ãµes e atualiza o orÃ§amento no banco de dados.
   c. **Excluir:** Selecionar um orÃ§amento e confirmar a exclusÃ£o. O sistema remove o orÃ§amento e seus detalhes do banco
   de dados.
4. O sistema exibe uma mensagem de sucesso apÃ³s cada operaÃ§Ã£o e atualiza a lista de orÃ§amentos.

## ğŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - Alertas de Estouro/Quase Estouro

1. O sistema monitora continuamente as transaÃ§Ãµes do usuÃ¡rio em relaÃ§Ã£o aos orÃ§amentos definidos.
2. Se o gasto em uma categoria se aproximar ou exceder o valor orÃ§ado, o sistema envia alertas (ex: notificaÃ§Ãµes, email)
   ao usuÃ¡rio.

## ğŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Dados invÃ¡lidos

1. Durante a criaÃ§Ã£o ou ediÃ§Ã£o, se os dados informados forem invÃ¡lidos (ex: `budgeted_amount` negativo, `start_date`
   apÃ³s `end_date`, `category_id` inexistente), o sistema exibe uma mensagem de erro especÃ­fica.
2. O sistema retorna ao formulÃ¡rio para que o usuÃ¡rio corrija os dados.

### âš ï¸ FE02 - OrÃ§amento nÃ£o encontrado

1. Ao tentar visualizar, editar ou excluir um orÃ§amento com um `budgetId` invÃ¡lido, o sistema exibe uma mensagem de erro
   indicando que o orÃ§amento nÃ£o foi encontrado.

### âš ï¸ FE03 - Erro ao salvar/atualizar/excluir

1. Se ocorrer um erro interno no sistema durante as operaÃ§Ãµes, o sistema exibe uma mensagem de erro genÃ©rica e sugere
   que o usuÃ¡rio tente novamente mais tarde.

## ğŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP - Criar OrÃ§amento Mensal

```http
POST /api/budgets HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]

{
  "name": "OrÃ§amento de Novembro 2023",
  "period_type": "monthly",
  "start_date": "2023-11-01",
  "end_date": "2023-11-30",
  "category_budgets": [
    {
      "category_id": "uuid-da-categoria-alimentacao",
      "budgeted_amount": 500.00
    },
    {
      "category_id": "uuid-da-categoria-transporte",
      "budgeted_amount": 150.00
    }
  ]
}
```

### RequisiÃ§Ã£o HTTP - Listar OrÃ§amentos

```http
GET /api/budgets HTTP/1.1
Host: api.metakyasshu.com
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]
```

### RequisiÃ§Ã£o HTTP - Atualizar OrÃ§amento

```http
PUT /api/budgets/a1b2c3d4e5f6-1234-5678-90ab-cdef12345678 HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]

{
  "name": "OrÃ§amento de Novembro 2023 (Revisado)",
  "category_budgets": [
    {
      "category_id": "uuid-da-categoria-alimentacao",
      "budgeted_amount": 550.00
    },
    {
      "category_id": "uuid-da-categoria-transporte",
      "budgeted_amount": 150.00
    }
  ]
}
```

### RequisiÃ§Ã£o HTTP - Excluir OrÃ§amento

```http
DELETE /api/budgets/a1b2c3d4e5f6-1234-5678-90ab-cdef12345678 HTTP/1.1
Host: api.metakyasshu.com
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]
```

---

> ---------------------------------------------------------------------------
> #### ğŸ’° METAKYASSHU ğŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 