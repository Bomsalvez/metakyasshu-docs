# RF006.3 ðŸ’³ Cadastro de cartÃµes de crÃ©dito/dÃ©bito

## ðŸ“ DescriÃ§Ã£o

Esta funcionalidade permite que o usuÃ¡rio cadastre seus cartÃµes de crÃ©dito e dÃ©bito no sistema, para que possa
associÃ¡-los a transaÃ§Ãµes e gerenciar seus gastos de forma centralizada.

## ðŸ‘¥ Atores

- ðŸ‘¤ UsuÃ¡rio Autenticado

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio deve estar logado no sistema.

## ðŸ”Œ Endpoints

- `POST /api/card`

## ðŸ“‹ Dados do CartÃ£o

| Campo             | Tipo     | ObrigatÃ³rio | DescriÃ§Ã£o                                   | RestriÃ§Ãµes                      |
|-------------------|----------|-------------|---------------------------------------------|---------------------------------|
| `card_number`     | `string` | âœ… Sim       | NÃºmero completo do cartÃ£o                   | Formato numÃ©rico, 13-19 dÃ­gitos |
| `expiry_date`     | `string` | âœ… Sim       | Data de validade (MM/AA)                    | Formato MM/AA vÃ¡lido, futuro    |
| `cvc`             | `string` | âœ… Sim       | CÃ³digo de seguranÃ§a do cartÃ£o               | 3 ou 4 dÃ­gitos numÃ©ricos        |
| `cardholder_name` | `string` | âœ… Sim       | Nome do titular do cartÃ£o                   | MÃ­nimo de 3 caracteres          |
| `card_type`       | `string` | âœ… Sim       | Tipo de cartÃ£o                              | `credit`, `debit`               |
| `flag`            | `string` | â¬œ NÃ£o       | Bandeira do cartÃ£o (Visa, Mastercard, etc.) | Texto livre                     |

## ðŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    actor U as UsuÃ¡rio
    participant S as Sistema
    participant BD as Banco de Dados
    U->>S: Acessa a seÃ§Ã£o de cartÃµes
    S->>U: Exibe a opÃ§Ã£o para adicionar novo cartÃ£o
    U->>S: Informa os dados do cartÃ£o (nÃºmero, validade, CVC, nome, tipo, bandeira)
    S->>S: Valida os dados do cartÃ£o
    S->>BD: Salva o novo cartÃ£o
    BD->>S: Confirma o salvamento
    S->>U: Exibe mensagem de sucesso e o novo cartÃ£o na lista
```

1. O usuÃ¡rio autenticado acessa a seÃ§Ã£o de gerenciamento de cartÃµes.
2. O sistema exibe a opÃ§Ã£o para adicionar um novo cartÃ£o.
3. O usuÃ¡rio preenche os dados solicitados para o cartÃ£o (nÃºmero, data de validade, CVC, nome do titular, tipo de cartÃ£o
   e, opcionalmente, a bandeira).
4. O sistema valida os dados informados, verificando o formato e a validade do cartÃ£o.
5. O sistema salva as informaÃ§Ãµes do novo cartÃ£o associado ao perfil do usuÃ¡rio no banco de dados.
6. O sistema exibe uma mensagem de confirmaÃ§Ã£o de sucesso e o novo cartÃ£o Ã© adicionado Ã  lista de cartÃµes do usuÃ¡rio.

## ðŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - CartÃ£o jÃ¡ cadastrado

1. No passo 4 do fluxo principal, se o nÃºmero do cartÃ£o informado jÃ¡ corresponder a um cartÃ£o previamente cadastrado
   pelo usuÃ¡rio, o sistema exibe uma mensagem de erro indicando que o cartÃ£o jÃ¡ existe.
2. O sistema retorna ao passo 3 do fluxo principal para que o usuÃ¡rio revise os dados ou cancele a operaÃ§Ã£o.

## ðŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Dados invÃ¡lidos

1. No passo 4 do fluxo principal, se os dados informados forem invÃ¡lidos (ex: nÃºmero de cartÃ£o com formato incorreto,
   data de validade expirada, CVC invÃ¡lido), o sistema exibe uma mensagem de erro especÃ­fica para o campo invÃ¡lido.
2. O sistema retorna ao passo 3 do fluxo principal para que o ator corrija os dados informados.

### âš ï¸ FE02 - Erro no sistema ao salvar o cartÃ£o

1. No passo 5 do fluxo principal, se ocorrer um erro interno no sistema ao tentar salvar o cartÃ£o, o sistema exibe uma
   mensagem de erro genÃ©rica e sugere que o usuÃ¡rio tente novamente mais tarde.

## ðŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP - Cadastrar CartÃ£o

```http
POST /api/card HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]

{
  "card_number": "4000123456789010",
  "expiry_date": "12/25",
  "cvc": "123",
  "cardholder_name": "JOAO DA SILVA",
  "card_type": "credit",
  "flag": "Visa"
}
```

---

> ---------------------------------------------------------------------------
> #### ðŸ’° METAKYASSHU ðŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 