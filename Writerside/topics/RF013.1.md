# RF013.1 ğŸ“ˆ GeraÃ§Ã£o de relatÃ³rios financeiros

## ğŸ“ DescriÃ§Ã£o

Esta funcionalidade permite a geraÃ§Ã£o de relatÃ³rios financeiros personalizÃ¡veis, como extratos, balanÃ§os e
demonstrativos de fluxo de caixa, com filtros por perÃ­odo, categoria, conta e forma de pagamento, para auxiliar na
anÃ¡lise e tomada de decisÃµes financeiras.

## ğŸ‘¥ Atores

- ğŸ‘¤ UsuÃ¡rio Autenticado

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio deve estar logado no sistema.
- O usuÃ¡rio deve ter transaÃ§Ãµes financeiras registradas.

## ğŸ”Œ Endpoints

- `POST /api/reports/generate`
- `GET /api/reports/available-types`

## ğŸ“‹ Dados para GeraÃ§Ã£o de RelatÃ³rio

| Campo                | Tipo            | ObrigatÃ³rio | DescriÃ§Ã£o                                          | RestriÃ§Ãµes                                       |
|----------------------|-----------------|-------------|----------------------------------------------------|--------------------------------------------------|
| `report_type`        | `string`        | âœ… Sim       | Tipo de relatÃ³rio a ser gerado                     | `statement`, `balance`, `cash_flow`              |
| `start_date`         | `string`        | âœ… Sim       | Data de inÃ­cio do perÃ­odo do relatÃ³rio             | Formato YYYY-MM-DD                               |
| `end_date`           | `string`        | âœ… Sim       | Data de tÃ©rmino do perÃ­odo do relatÃ³rio            | Formato YYYY-MM-DD, apÃ³s ou igual a `start_date` |
| `category_ids`       | `array<string>` | â¬œ NÃ£o       | IDs das categorias a incluir no relatÃ³rio          | Array de UUIDs vÃ¡lidos                           |
| `account_ids`        | `array<string>` | â¬œ NÃ£o       | IDs das contas a incluir no relatÃ³rio              | Array de UUIDs vÃ¡lidos                           |
| `payment_method_ids` | `array<string>` | â¬œ NÃ£o       | IDs das formas de pagamento a incluir no relatÃ³rio | Array de UUIDs vÃ¡lidos                           |
| `output_format`      | `string`        | â¬œ NÃ£o       | Formato de saÃ­da do relatÃ³rio                      | `pdf`, `csv` (padrÃ£o: `pdf`)                     |

## ğŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    actor U as UsuÃ¡rio
    participant S as Sistema
    participant BD as Banco de Dados
    U->>S: Acessa a seÃ§Ã£o de RelatÃ³rios
    S->>U: Exibe opÃ§Ãµes de tipo de relatÃ³rio e filtros
    U->>S: Seleciona tipo de relatÃ³rio e filtros (perÃ­odo, categorias, contas, formas de pagamento, formato de saÃ­da)
    S->>S: Valida os parÃ¢metros do relatÃ³rio
    S->>BD: Solicita dados financeiros com base nos filtros
    BD->>S: Retorna dados brutos
    S->>S: Processa dados e gera relatÃ³rio no formato especificado
    S->>U: Disponibiliza o relatÃ³rio para download/visualizaÃ§Ã£o
```

1. O usuÃ¡rio autenticado acessa a seÃ§Ã£o de RelatÃ³rios no sistema.
2. O sistema exibe as opÃ§Ãµes de tipos de relatÃ³rios disponÃ­veis (ex: Extrato, BalanÃ§o, Fluxo de Caixa) e os filtros que
   podem ser aplicados (perÃ­odo, categorias, contas bancÃ¡rias, formas de pagamento, formato de saÃ­da).
3. O usuÃ¡rio seleciona o tipo de relatÃ³rio desejado e configura os filtros de acordo com suas necessidades. Escolhe
   tambÃ©m o formato de saÃ­da (PDF ou CSV).
4. O sistema valida os parÃ¢metros de entrada, garantindo que as datas sÃ£o vÃ¡lidas e que os IDs de
   categorias/contas/formas de pagamento existem e pertencem ao usuÃ¡rio.
5. O sistema consulta o banco de dados para recuperar as transaÃ§Ãµes e dados financeiros relevantes com base nos filtros
   aplicados.
6. O sistema processa os dados, realiza os cÃ¡lculos necessÃ¡rios (ex: saldos, totais por categoria) e gera o relatÃ³rio no
   formato escolhido.
7. O sistema disponibiliza o relatÃ³rio gerado para download ou visualizaÃ§Ã£o direta na interface.

## ğŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - RelatÃ³rios Agendados

1. O usuÃ¡rio pode agendar a geraÃ§Ã£o de relatÃ³rios periÃ³dicos (ex: extrato mensal) que sÃ£o enviados automaticamente por
   e-mail ou disponibilizados em uma Ã¡rea especÃ­fica do sistema.

### âš ï¸ FA02 - RelatÃ³rios Comparativos

1. O sistema pode oferecer a opÃ§Ã£o de gerar relatÃ³rios comparativos entre diferentes perÃ­odos ou entre categorias, para
   anÃ¡lise de tendÃªncias.

## ğŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - PerÃ­odo sem dados

1. Se o perÃ­odo selecionado para o relatÃ³rio nÃ£o contiver nenhuma transaÃ§Ã£o ou dado financeiro, o sistema informa ao
   usuÃ¡rio que nÃ£o hÃ¡ dados para o perÃ­odo e nÃ£o gera o relatÃ³rio.

### âš ï¸ FE02 - ParÃ¢metros de filtro invÃ¡lidos

1. Se os parÃ¢metros de filtro (ex: `category_ids`, `account_ids`) contiverem IDs inexistentes ou invÃ¡lidos para o
   usuÃ¡rio, o sistema exibe uma mensagem de erro indicando o problema.
2. O sistema retorna Ã  tela de filtros para que o usuÃ¡rio corrija os dados.

### âš ï¸ FE03 - Erro na geraÃ§Ã£o do relatÃ³rio

1. Se ocorrer um erro interno no sistema durante o processamento ou a geraÃ§Ã£o do arquivo do relatÃ³rio, o sistema exibe
   uma mensagem de erro genÃ©rica e sugere que o usuÃ¡rio tente novamente mais tarde.

## ğŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP - Gerar Extrato Mensal em PDF

```http
POST /api/reports/generate HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]

{
  "report_type": "statement",
  "start_date": "2023-10-01",
  "end_date": "2023-10-31",
  "output_format": "pdf"
}
```

### RequisiÃ§Ã£o HTTP - Gerar BalanÃ§o por Categorias em CSV

```http
POST /api/reports/generate HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json
Authorization: Bearer [TOKEN_DE_AUTENTICACAO]

{
  "report_type": "balance",
  "start_date": "2023-01-01",
  "end_date": "2023-12-31",
  "category_ids": ["uuid-da-categoria-alimentacao", "uuid-da-categoria-transporte"],
  "output_format": "csv"
}
```

---

> ---------------------------------------------------------------------------
> #### ğŸ’° METAKYASSHU ğŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 