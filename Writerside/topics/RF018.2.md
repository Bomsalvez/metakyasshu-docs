# RF018.2 ðŸ”„ Compartilhamento seletivo de metas financeiras

## ðŸ“ DescriÃ§Ã£o

Esta funcionalidade permite o compartilhamento seletivo de metas financeiras com membros especÃ­ficos do grupo ou
usuÃ¡rios individuais. O usuÃ¡rio pode escolher com quem compartilhar suas metas financeiras, mantendo a privacidade e
colaborando de forma controlada.

## ðŸ‘¥ Atores

- ðŸ‘¤ **UsuÃ¡rio Remetente**: O usuÃ¡rio que deseja compartilhar uma meta financeira.
- ðŸ‘¥ **Membro do Grupo/UsuÃ¡rio DestinatÃ¡rio**: O membro do grupo ou usuÃ¡rio individual com quem a meta financeira serÃ¡
  compartilhada.

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio remetente deve estar autenticado no sistema.
- A meta financeira a ser compartilhada deve existir e pertencer ao usuÃ¡rio remetente.
- O membro do grupo ou usuÃ¡rio destinatÃ¡rio deve existir.

## ðŸ”Œ Endpoints

- `POST /api/goals/{goalId}/share`

## ðŸ“‹ Dados de Compartilhamento de Meta Financeira

| Campo       | Tipo     | ObrigatÃ³rio | DescriÃ§Ã£o                                                              | RestriÃ§Ãµes                                                      |
|-------------|----------|-------------|------------------------------------------------------------------------|-----------------------------------------------------------------|
| `goalId`    | `string` | âœ… Sim       | ID Ãºnico da meta financeira a ser compartilhada.                       | Deve ser um ID de meta vÃ¡lido e existente do usuÃ¡rio remetente. |
| `shareWith` | `array`  | âœ… Sim       | Lista de IDs de usuÃ¡rios ou grupos com quem a meta serÃ¡ compartilhada. | Deve conter IDs de usuÃ¡rios ou grupos vÃ¡lidos e existentes.     |

## ðŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    actor A as UsuÃ¡rio Remetente
    participant S as Sistema
    A ->> S: 1. Seleciona uma meta financeira para compartilhar e escolhe destinatÃ¡rios (POST /api/goals/{goalId}/share)
    S ->> S: 2. Valida a meta e os destinatÃ¡rios
    S ->> S: 3. Registra o compartilhamento da meta no banco de dados
    S ->> A: 4. Retorna confirmaÃ§Ã£o de sucesso (HTTP 200 OK)
```

1. O UsuÃ¡rio Remetente envia uma requisiÃ§Ã£o POST para `/api/goals/{goalId}/share` com os IDs dos destinatÃ¡rios no corpo
   da requisiÃ§Ã£o.
2. O sistema valida se o `goalId` pertence ao UsuÃ¡rio Remetente e se os `shareWith` IDs sÃ£o vÃ¡lidos (usuÃ¡rios ou grupos
   existentes).
3. O sistema registra o relacionamento de compartilhamento para a meta financeira e os destinatÃ¡rios especificados no
   banco de dados.
4. O sistema retorna uma resposta HTTP 200 OK com uma mensagem de sucesso.

## ðŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - Compartilhamento com um Grupo

1. O UsuÃ¡rio Remetente inclui o ID de um grupo no array `shareWith`.
2. O sistema compartilha a meta financeira com todos os membros ativos desse grupo.

### âš ï¸ FA02 - Compartilhamento com UsuÃ¡rios Individuais

1. O UsuÃ¡rio Remetente inclui IDs de usuÃ¡rios individuais no array `shareWith`.
2. O sistema compartilha a meta financeira com cada um dos usuÃ¡rios especificados.

## ðŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Meta Financeira NÃ£o Encontrada ou NÃ£o Pertencente ao UsuÃ¡rio

1. O `goalId` especificado nÃ£o Ã© encontrado ou nÃ£o pertence ao UsuÃ¡rio Remetente.
2. O sistema retorna uma resposta HTTP 404 Not Found.

### âš ï¸ FE02 - DestinatÃ¡rio(s) InvÃ¡lido(s)

1. Um ou mais IDs em `shareWith` nÃ£o sÃ£o de usuÃ¡rios ou grupos vÃ¡lidos e existentes.
2. O sistema retorna uma resposta HTTP 400 Bad Request.

### âš ï¸ FE03 - Meta JÃ¡ Compartilhada

1. O usuÃ¡rio tenta compartilhar uma meta que jÃ¡ estÃ¡ compartilhada com um ou mais dos destinatÃ¡rios especificados.
2. O sistema pode optar por ignorar o compartilhamento duplicado para os destinatÃ¡rios jÃ¡ existentes e retornar um HTTP
   200 OK, ou retornar um HTTP 409 Conflict.

## ðŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP para Compartilhar Meta Financeira com UsuÃ¡rios e um Grupo

```http
POST /api/goals/goal_abc123/share HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "shareWith": ["usr_def456", "grp_ghi789", "usr_jkl012"]
}
```

### RequisiÃ§Ã£o HTTP para Compartilhar Meta Financeira Apenas com um UsuÃ¡rio

```http
POST /api/goals/goal_xyz987/share HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "shareWith": ["usr_mno345"]
}
```

---

> ---------------------------------------------------------------------------
> #### ðŸ’° METAKYASSHU ðŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 