# RF022.1 ðŸŽ CriaÃ§Ã£o e gestÃ£o de vaquinhas digitais

## ðŸ“ DescriÃ§Ã£o

Esta funcionalidade permite a criaÃ§Ã£o e gestÃ£o de vaquinhas digitais. Os usuÃ¡rios podem definir um objetivo, valor-alvo,
prazo e convidar participantes para contribuir. Isso facilita a arrecadaÃ§Ã£o de fundos para eventos, presentes ou causas
compartilhadas, com acompanhamento em tempo real das contribuiÃ§Ãµes.

## ðŸ‘¥ Atores

- ðŸ‘¤ **Organizador da Vaquinha**: O usuÃ¡rio que cria e gerencia a vaquinha.
- ðŸ‘¥ **Contribuinte**: O usuÃ¡rio que faz doaÃ§Ãµes para a vaquinha.

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio (Organizador ou Contribuinte) deve estar autenticado no sistema.
- Para criar, o Organizador deve ter um perfil ativo.
- Para contribuir, a vaquinha deve existir e estar ativa.

## ðŸ”Œ Endpoints

- `POST /api/fundraisers` (Criar Vaquinha)
- `GET /api/fundraisers/{fundraiserId}` (Obter Detalhes da Vaquinha)
- `PUT /api/fundraisers/{fundraiserId}` (Atualizar Vaquinha)
- `POST /api/fundraisers/{fundraiserId}/contribute` (Contribuir para Vaquinha)

## ðŸ“‹ Dados de Vaquinha Digital

### CriaÃ§Ã£o/AtualizaÃ§Ã£o de Vaquinha

| Campo          | Tipo                | ObrigatÃ³rio | DescriÃ§Ã£o                        | RestriÃ§Ãµes                                                   |
|----------------|---------------------|-------------|----------------------------------|--------------------------------------------------------------|
| `name`         | `string`            | âœ… Sim       | Nome da vaquinha.                | MÃ¡ximo 100 caracteres.                                       |
| `description`  | `string`            | âŒ NÃ£o       | DescriÃ§Ã£o detalhada da vaquinha. | MÃ¡ximo 500 caracteres.                                       |
| `targetAmount` | `number`            | âœ… Sim       | Valor total a ser arrecadado.    | Deve ser um nÃºmero positivo.                                 |
| `currency`     | `string`            | âœ… Sim       | Moeda do valor-alvo.             | Ex: `BRL`, `USD`.                                            |
| `dueDate`      | `string` (ISO 8601) | âŒ NÃ£o       | Data limite para arrecadaÃ§Ã£o.    | Formato `YYYY-MM-DD`.                                        |
| `visibility`   | `string`            | âœ… Sim       | Visibilidade da vaquinha.        | Valores permitidos: `PUBLIC`, `PRIVATE` (apenas convidados). |
| `ownerId`      | `string`            | âœ… Sim       | ID do usuÃ¡rio organizador.       | Gerado automaticamente pelo sistema.                         |

### ContribuiÃ§Ã£o para Vaquinha

| Campo           | Tipo      | ObrigatÃ³rio | DescriÃ§Ã£o                           | RestriÃ§Ãµes                                     |
|-----------------|-----------|-------------|-------------------------------------|------------------------------------------------|
| `fundraiserId`  | `string`  | âœ… Sim       | ID Ãºnico da vaquinha.               | Deve ser um ID de vaquinha vÃ¡lido e existente. |
| `amount`        | `number`  | âœ… Sim       | Valor da contribuiÃ§Ã£o.              | Deve ser um nÃºmero positivo.                   |
| `contributorId` | `string`  | âœ… Sim       | ID do usuÃ¡rio contribuinte.         | Gerado automaticamente pelo sistema.           |
| `anonymous`     | `boolean` | âŒ NÃ£o       | Indica se a contribuiÃ§Ã£o Ã© anÃ´nima. | PadrÃ£o: `false`.                               |

## ðŸ”„ Fluxo Principal - CriaÃ§Ã£o de Vaquinha

```mermaid
sequenceDiagram
    actor O as Organizador da Vaquinha
    participant S as Sistema
    O ->> S: 1. Preenche formulÃ¡rio de criaÃ§Ã£o de vaquinha (POST /api/fundraisers)
    S ->> S: 2. Valida dados da vaquinha
    S ->> S: 3. Cria a vaquinha no banco de dados
    S ->> O: 4. Retorna detalhes da vaquinha criada (HTTP 201 Created)
```

1. O Organizador da Vaquinha envia uma requisiÃ§Ã£o POST para `/api/fundraisers` com os detalhes da nova vaquinha.
2. O sistema valida os dados recebidos (e.g., `targetAmount` positivo, `currency` vÃ¡lido).
3. O sistema cria um novo registro de vaquinha no banco de dados, associando-o ao `ownerId` do usuÃ¡rio logado.
4. O sistema retorna uma resposta HTTP 201 Created com os detalhes da vaquinha recÃ©m-criada, incluindo seu
   `fundraiserId`.

## ðŸ”„ Fluxo Principal - ContribuiÃ§Ã£o para Vaquinha

```mermaid
sequenceDiagram
    actor C as Contribuinte
    participant S as Sistema
    C ->> S: 1. Informa valor e solicita contribuiÃ§Ã£o (POST /api/fundraisers/{fundraiserId}/contribute)
    S ->> S: 2. Valida a vaquinha e o valor da contribuiÃ§Ã£o
    S ->> S: 3. Registra a contribuiÃ§Ã£o e atualiza o `currentAmount` da vaquinha
    S ->> C: 4. Retorna confirmaÃ§Ã£o de sucesso (HTTP 200 OK)
```

1. O Contribuinte envia uma requisiÃ§Ã£o POST para `/api/fundraisers/{fundraiserId}/contribute` com o `amount` da
   contribuiÃ§Ã£o (e opcionalmente `anonymous`).
2. O sistema valida se a `fundraiserId` existe e estÃ¡ ativa, e se o `amount` Ã© vÃ¡lido.
3. O sistema registra a contribuiÃ§Ã£o no banco de dados e atualiza o `currentAmount` arrecadado na vaquinha.
4. O sistema retorna uma resposta HTTP 200 OK com uma mensagem de sucesso.

## ðŸ”€ Fluxos Alternativos

### âš ï¸ FA01 - Vaquinha Privada

1. Se `visibility` for `PRIVATE`, apenas usuÃ¡rios convidados (gerenciados por outra funcionalidade) podem contribuir ou
   visualizar detalhes.
2. O sistema verifica a autorizaÃ§Ã£o do usuÃ¡rio antes de permitir acesso Ã  vaquinha privada.

### âš ï¸ FA02 - Atingir o Objetivo

1. Quando o `currentAmount` atinge ou excede o `targetAmount`.
2. O sistema pode automaticamente marcar a vaquinha como "ConcluÃ­da" e notificar o Organizador.

## ðŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Vaquinha NÃ£o Encontrada

1. O `fundraiserId` especificado nÃ£o Ã© encontrado.
2. O sistema retorna uma resposta HTTP 404 Not Found.

### âš ï¸ FE02 - Valor de ContribuiÃ§Ã£o InvÃ¡lido

1. O `amount` fornecido Ã© negativo, zero ou excede algum limite predefinido.
2. O sistema retorna uma resposta HTTP 400 Bad Request.

### âš ï¸ FE03 - Prazo Expirado

1. A `dueDate` da vaquinha jÃ¡ passou e nÃ£o permite mais contribuiÃ§Ãµes.
2. O sistema retorna uma resposta HTTP 403 Forbidden.

### âš ï¸ FE04 - UsuÃ¡rio NÃ£o Autorizado (para atualizaÃ§Ã£o/visualizaÃ§Ã£o privada)

1. Um usuÃ¡rio tenta atualizar ou visualizar uma vaquinha que nÃ£o pertence a ele ou que Ã© privada e ele nÃ£o foi
   convidado.
2. O sistema retorna uma resposta HTTP 403 Forbidden.

## ðŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP para Criar uma Vaquinha PÃºblica

```http
POST /api/fundraisers HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "name": "Viagem de AniversÃ¡rio da Ana",
  "description": "ArrecadaÃ§Ã£o para a viagem surpresa de 30 anos da Ana para as Maldivas!",
  "targetAmount": 5000.00,
  "currency": "BRL",
  "dueDate": "2024-12-31",
  "visibility": "PUBLIC"
}
```

### RequisiÃ§Ã£o HTTP para Contribuir para uma Vaquinha (nÃ£o anÃ´nima)

```http
POST /api/fundraisers/fdr_abc123/contribute HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "amount": 50.00,
  "anonymous": false
}
```

### RequisiÃ§Ã£o HTTP para Atualizar o Prazo de uma Vaquinha

```http
PUT /api/fundraisers/fdr_abc123 HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "dueDate": "2025-01-31"
}
```

---

> ---------------------------------------------------------------------------
> #### ðŸ’° METAKYASSHU ðŸ’°
> ***Transformando finanÃ§as em conquistas compartilhadas***
> --------------------------------------------------------------------------- 