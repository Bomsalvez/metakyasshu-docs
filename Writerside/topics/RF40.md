# ðŸ”” RF40 - Notificar UsuÃ¡rios 

![Logo.png](Logo.png){ width=150 }

## ðŸ“ DescriÃ§Ã£o

Esta funcionalidade permite que o sistema envie notificaÃ§Ãµes para usuÃ¡rios sobre eventos importantes.

## ðŸ‘¥ Atores

- ðŸ¤– Sistema

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O usuÃ¡rio deve estar cadastrado no sistema.
- O usuÃ¡rio deve ter um email vÃ¡lido cadastrado.

## ðŸ”Œ Endpoints

- `POST /api/notification`

## ðŸ“‹ Dados

| Campo      | Tipo     | ObrigatÃ³rio | DescriÃ§Ã£o            | RestriÃ§Ãµes |
|------------|----------|-------------|----------------------|------------|
| `user_id`  | `number` | âœ… Sim      | ID do usuÃ¡rio        |            |
| `type`     | `string` | âœ… Sim      | Tipo de notificaÃ§Ã£o  | EMAIL, PUSH |
| `title`    | `string` | âœ… Sim      | TÃ­tulo da mensagem   |            |
| `message`  | `string` | âœ… Sim      | ConteÃºdo da mensagem |            |

## ðŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    participant S as Sistema
    participant N as ServiÃ§o de NotificaÃ§Ã£o
    participant U as UsuÃ¡rio
    
    S->>N: Envia notificaÃ§Ã£o
    N->>N: Valida dados
    N->>U: Envia email
    U->>U: Recebe notificaÃ§Ã£o
    N->>S: Confirma envio
    S->>S: Registra envio
```

1. O sistema identifica a necessidade de enviar uma notificaÃ§Ã£o.
2. O sistema prepara os dados da notificaÃ§Ã£o.
3. O sistema envia a notificaÃ§Ã£o para o serviÃ§o de notificaÃ§Ã£o.
4. O serviÃ§o de notificaÃ§Ã£o valida os dados.
5. O serviÃ§o de notificaÃ§Ã£o envia a notificaÃ§Ã£o para o usuÃ¡rio.
6. O usuÃ¡rio recebe a notificaÃ§Ã£o.
7. O serviÃ§o de notificaÃ§Ã£o confirma o envio para o sistema.
8. O sistema registra o envio da notificaÃ§Ã£o.

## ðŸ”€ Fluxos Alternativos

### ðŸ”„ FA01 - NotificaÃ§Ã£o Push
1. No passo 5 do fluxo principal, se o tipo for PUSH, o serviÃ§o de notificaÃ§Ã£o envia uma notificaÃ§Ã£o push.
2. O usuÃ¡rio recebe a notificaÃ§Ã£o no dispositivo.

## ðŸš« Fluxos de ExceÃ§Ã£o

### âš ï¸ FE01 - Email invÃ¡lido
1. No passo 4 do fluxo principal, se o email for invÃ¡lido, o serviÃ§o de notificaÃ§Ã£o retorna erro.
2. O sistema registra o erro de envio.

### âš ï¸ FE02 - Falha no envio
1. No passo 5 do fluxo principal, se houver falha no envio, o serviÃ§o de notificaÃ§Ã£o retorna erro.
2. O sistema tenta reenviar a notificaÃ§Ã£o.
3. Se apÃ³s 3 tentativas ainda houver falha, o sistema registra o erro.

## ðŸ§ª Exemplos de Uso

### RequisiÃ§Ã£o HTTP
```http
POST /api/notification HTTP/1.1
Host: api.metakyasshu.com
Content-Type: application/json

{
  "user_id": 123,
  "type": "EMAIL",
  "title": "Bem-vindo ao Metakyasshu",
  "message": "OlÃ¡ JoÃ£o, bem-vindo ao Metakyasshu! Sua conta foi criada com sucesso."
}
```

### Resposta
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "message": "NotificaÃ§Ã£o enviada com sucesso",
  "data": {
    "id": 1,
    "user_id": 123,
    "type": "EMAIL",
    "title": "Bem-vindo ao Metakyasshu",
    "message": "OlÃ¡ JoÃ£o, bem-vindo ao Metakyasshu! Sua conta foi criada com sucesso.",
    "sent_at": "2023-07-15T10:30:00Z"
  }
}
```

> ---------------------------------------------------------------------------
> #### ðŸ’° Sistema de GestÃ£o Financeira ðŸ’°
> ***Controlando suas finanÃ§as de forma simples e eficiente***
> ---------------------------------------------------------------------------